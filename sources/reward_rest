#!/usr/bin/env bash
# 80 char description
SOURCE_DESC80="Reward rest used 1000x over"

SUBJECTS_DIR="/data/Luna2/Reward/FS_Subjects/"
DICOM_PAT="MR*"

FUNCTR="1.5"
FUNCSLICEACQ="seqasc"

MRROOT="/data/Luna1/Raw/MRCTR/"

DCMRECONDIR="/data/Luna2/Reward/Rest/"


function subj_t1 {
 wantonlyoneid $@ || return 1

 ## special cases for special subjects (rescans or other ambigiousness)
 # none yet

 # do not use original, use FS warped -- so we can use aseg
 #subj_mr_pat $MRROOT/$1 'axial_mprage_256x208*' 176 || return 1

 # FS T1
 file_exists_test "$SUBJECTS_DIR/$1/mri/T1.mgz"
}

# find T1 preprocessed from another source
function subj_t1_prev {
 file_exists_test /data/Luna2/Reward/Rest/$id/afni_restproc/preprocessMprage_2mm/
}

# segemention mask from freesurfer
function subj_FS_aseg {
 wantonlyoneid $@ || return 1
 file_exists_test "$SUBJECTS_DIR/$1/mri/aseg.mgz"
}

function subj_t2 {
 wantonlyoneid $@ || return 1
 # would reconstruct from
 #subj_mr_pat $MRROOT/$1 'rest_384x384*' 200 || return 1

 # use what we've already made
 file_exists_test "$DCMRECONDIR/$1/${1}_restepi+orig.HEAD"
}
subj_t2_construct() {
 wantonlyoneid $@ || return 1
 # would reconstruct from
 restdcmdir=$(subj_t2 $1) || return 1

 [ ! -d $DCMRECONDIR/$1 ] && mkdir -p $DCMRECONDIR/$1
 oldwd=$(pwd)
 cd $DCMRECONDIR/$1

 [ ! -r  "$DCMRECONDIR/$1/${1}_restepi+orig.HEAD" ] && 
 Dimon -infile_prefix $restdcmdir/ \
         -GERT_Reco \
         -dicom_org \
         -sort_by_acq_time \
         -gert_create_dataset \
         -gert_to3d_prefix ${1}_restepi \
         -quit
 cd $oldwd
 # use what we've already made
 file_exists_test "$DCMRECONDIR/$1/${1}_restepi+orig.HEAD"
}

function subj_MRT1 {
 wantonlyoneid $@ || return 1
 subj_mr_pat $MRROOT/$1 'axial_mprage_256x208*' 176 || return 1
}


# have FS, shouldn't need to do this here
#function subj_aseg {
# wantonlyoneid $@ || return 1
# file_exists_test "$SUBJECTS_DIR/$1/mri/aseg.mgz"
#}

function subj_physio {
 wantonlyoneid $@ || return 1
 warn "PHYSIO NOT IMPLEMENTED ${BASH_SOURCE}"
 return 0

 # physiofile="$(find $physioDir/$SUBJECT/$VISIT/ -iname '*rest*RetroTS.slibase.1D'|tail -n1)"
}

function list_all {
cat <<EOF
10152_20100514
10152_20111123
10153_20100604
10153_20111128
10156_20100313
10156_20110923
10173_20100313
10173_20110820
10181_20090604
10181_20101124
10181_20130129
10300_20081112
10300_20100702
10300_20111201
10385_20081111
10406_20090216
10406_20100828
10406_20120524
10466_20100102
10466_20110910
10466_20130923
10565_20100624
10565_20120107
10567_20090114
10567_20100810
10567_20130503
10568_20090112
10568_20100619
10568_20120110
10572_20090303
10572_20110112
10572_20120514
10585_20100415
10585_20120822
10589_20100525
10589_20111121
10599_20090124
10599_20100726
10599_20131022
10604_20100313
10604_20120121
10608_20100615
10608_20111122
10616_20081122
10616_20100624
10616_20120130
10623_20090113
10623_20120111
10625_20090226
10626_20090214
10626_20100916
10626_20121008
10627_20090214
10627_20101123
10627_20111123
10627_20121219
10628_20090214
10629_20090203
10629_20100901
10629_20100929
10629_20120317
10633_20090228
10635_20090210
10636_20090307
10636_20100828
10636_20131125
10637_20090307
10637_20100828
10637_20121112
10638_20100809
10638_20120216
10644_20090323
10644_20101111
10644_20120516
10646_20090410
10648_20100603
10652_20090410
10652_20101016
10653_20090401
10653_20101001
10653_20121205
10654_20090408
10654_20100920
10655_20090408
10661_20090507
10661_20110325
10661_20120406
10662_20090507
10662_20101123
10662_20120406
10664_20090417
10665_20090417
10665_20101215
10665_20120611
10666_20090722
10666_20110425
10667_20090722
10667_20110415
10667_20120907
10671_20090606
10671_20110205
10672_20090606
10672_20131025
10673_20090519
10673_20110221
10673_20120821
10674_20090519
10675_20090519
10676_20090521
10677_06042011
10677_20090606
10677_20110604
10677_20120803
10678_20090606
10678_20101218
10678_20121219
10680_20090619
10680_20101222
10680_20120615
10689_20090611
10689_20110310
10689_20120919
10697_20090620
10697_20110217
10697_20120803
10699_20090810
10699_20110226
10699_20120915
10700_20090826
10700_20110317
10700_20120831
10701_20090804
10701_20110323
10701_20120906
10703_20090710
10703_20110118
10703_20120726
10707_20090713
10708_20090723
10708_20110803
10709_20090723
10709_20110803
10710_20090720
10711_20110126
10711_20121108
10712_20090720
10713_20090725
10713_20110212
10717_20110226
10717_20120915
10745_20090909
10747_20090901
10747_20110514
10747_20120828
10749_20090901
10749_20110616
10749_20130910
10757_20091028
10757_20091124
10757_20110601
10757_20121218
10758_20091031
10758_20110614
10758_20121009
10760_20091031
10760_20110513
10760_20121030
10761_20091120
10761_20110519
10761_20121001
10762_20091130
10762_20110907
10765_20091116
10765_20110912
10765_20121024
10766_20091201
10766_20110915
10766_20130130
10767_20110523
10767_20131207
10768_20091202
10768_20121212
10772_20091224
10772_20120503
10773_20100102
10773_20110709
10773_20130228
10774_20100102
10774_20110709
10774_20130228
10775_20091217
10776_20100327
10777_20100125
10778_20100326
10780_20100331
10780_20110823
10780_20130625
10782_20100323
10783_20100330
10784_20100331
10786_20100319
10786_20111201
10786_20131209
10787_20100519
10788_20100326
10788_20111217
10790_20100409
10790_20131014
10796_20100520
10796_20120220
10796_20130325
10797_20100405
10797_20111128
10797_20130524
10798_20100518
10798_20131007
10800_20100424
10801_20100426
10802_20100326
10802_20130528
10803_20100414
10804_20100525
10804_20111203
10805_20100412
10805_20111103
10805_20130508
10806_20100421
10806_20111230
10807_20100412
10808_20100501
10808_20120629
10808_20130709
10809_20100607
10809_20120405
10809_20131111
10811_20100410
10811_20111116
10811_20140417
10812_20100508
10812_20111206
10812_20140109
10813_20100422
10813_20120106
10814_20100524
10814_20130731
10817_20100515
10817_20111220
10818_20100626
10818_20120714
10820_20100622
10820_20121025
10821_20100625
10821_20120321
10821_20140529
10822_20100622
10822_20120229
10822_20130812
10824_20100723
10824_20111108
10824_20131002
10826_20100726
10826_20120911
10826_20140414
10827_20100726
10839_20100821
10839_20120213
10839_20130916
10840_20100821
10840_20120207
10841_20100820
10841_20120618
10842_20100823
10843_20100816
10843_20120406
10845_20100924
10845_20120809
10847_20101016
10847_20120616
10847_20131005
10849_20101115
10849_20120813
10849_20140102
10850_20101115
10850_20121214
10850_20140204
10851_20101207
10851_20120921
10851_20131113
10852_20101213
10852_20120924
10852_20140207
10869_20110120
10869_20121005
10870_20110107
10871_20110103
10871_20121117
10872_20110113
10872_20120927
10872_20131202
10873_20110209
10873_20120807
10873_20140217
10874_20110119
10875_20110402
10877_20110212
10879_20110331
10879_20121110
10880_20110407
10880_20120926
10880_20140311
10881_20110520
10881_20121210
10887_20110531
10887_20121107
10888_20110608
10959_20130815
11055_20121102
11056_20121023
11058_20121109
11059_20121022
11062_20121102
11065_20121107
11066_20121109
11070_20121116
11074_20121130
11075_20130416
11078_20121114
11082_20121130
11084_20121213
11087_20121204
11094_20121221
11106_20130109
11113_20130117
11114_20130124
11123_20130211
11129_20130320
11130_20130218
11133_20130222
11137_20130329
11140_20130415
11141_20130308
11145_20130313
11148_20130328
11149_20130403
11152_20130501
11156_20130426
11157_20130501
11160_20130521
11162_20130521
11165_20140606
11168_20130613
11176_20130703
11178_20131111
11185_20130627
11187_20130802
11191_20130710
11197_20130909
11198_20130812
11212_20130913
11215_20131030
11218_20131015
11219_20131115
11220_20131101
11221_20131031
11224_20131107
11226_20131114
11227_20131213
11228_20131212
11230_20131127
11232_20140117
11237_20131220
11239_20131231
11241_20140204
11242_20140124
11244_20140211
11245_20140207
11248_20140221
11249_20140220
11251_20140227
11254_20140228
11257_20140306
11259_20140313
11261_20140318
11265_20140314
11266_20140321
11267_20140401
11268_20140328
11269_20140505
11270_20140328
11271_20140402
11272_20140408
11273_20140410
11275_20140422
11276_20140502
11278_20140407
11282_20140516
11283_20140501
11284_20140429
11285_20140522
11289_20140602
11290_20140602
11291_20140619
11292_20140616
11293_20140609
11295_20140620
11296_20140708
11297_20140617
11299_20140627
11301_20140724
11307_20140725
EOF
}



# all we care about
function list_all_firstonly {
cat <<EOF
10152_20100514
10153_20100604
10156_20100313
10173_20100313
10181_20090604
10300_20081112
10385_20081111
10406_20090216
10466_20100102
10565_20100624
10567_20090114
10568_20090112
10572_20090303
10585_20100415
10589_20100525
10599_20090124
10604_20100313
10608_20100615
10616_20081122
10623_20090113
10625_20090226
10626_20090214
10627_20090214
10628_20090214
10629_20090203
10633_20090228
10635_20090210
10636_20090307
10637_20090307
10638_20100809
10644_20090323
10646_20090410
10648_20100603
10652_20090410
10653_20090401
10654_20090408
10655_20090408
10661_20090507
10662_20090507
10664_20090417
10665_20090417
10666_20090722
10667_20090722
10671_20090606
10672_20090606
10673_20090519
10674_20090519
10675_20090519
10676_20090521
10678_20090606
10680_20090619
10689_20090611
10697_20090620
10699_20090810
10700_20090826
10701_20090804
10703_20090710
10707_20090713
10708_20090723
10709_20090723
10710_20090720
10711_20110126
10712_20090720
10713_20090725
10717_20110226
10745_20090909
10747_20090901
10749_20090901
10757_20091028
10758_20091031
10760_20091031
10761_20091120
10762_20091130
10765_20091116
10766_20091201
10767_20110523
10768_20091202
10772_20091224
10773_20100102
10774_20100102
10775_20091217
10777_20100125
10778_20100326
10780_20100331
10782_20100323
10783_20100330
10784_20100331
10786_20100319
10787_20100519
10788_20100326
10790_20100409
10796_20100520
10797_20100405
10798_20100518
10800_20100424
10801_20100426
10802_20100326
10803_20100414
10804_20100525
10805_20100412
10806_20100421
10807_20100412
10808_20100501
10809_20100607
10811_20100410
10812_20100508
10813_20100422
10814_20100524
10817_20100515
10818_20100626
10820_20100622
10821_20100625
10822_20100622
10824_20100723
10826_20100726
10827_20100726
10839_20100821
10840_20100821
10841_20100820
10842_20100823
10843_20100816
10845_20100924
10847_20101016
10849_20101115
10850_20101115
10851_20101207
10852_20101213
10869_20110120
10870_20110107
10871_20110103
10872_20110113
10873_20110209
10874_20110119
10875_20110402
10877_20110212
10879_20110331
10880_20110407
10881_20110520
10887_20110531
10888_20110608
10959_20130815
11055_20121102
11056_20121023
11058_20121109
11059_20121022
11062_20121102
11065_20121107
11066_20121109
11070_20121116
11074_20121130
11075_20130416
11078_20121114
11082_20121130
11084_20121213
11087_20121204
11094_20121221
11106_20130109
11113_20130117
11114_20130124
11123_20130211
11129_20130320
11130_20130218
11133_20130222
11137_20130329
11140_20130415
11141_20130308
11145_20130313
11148_20130328
11149_20130403
11152_20130501
11156_20130426
11157_20130501
11160_20130521
11162_20130521
11168_20130613
11176_20130703
11178_20131111
11185_20130627
11187_20130802
11191_20130710
11197_20130909
11198_20130812
11212_20130913
11215_20131030
11218_20131015
11219_20131115
11220_20131101
11221_20131031
11224_20131107
11226_20131114
EOF
}
